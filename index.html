<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Station Search Form</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
  }
  label {
    display: block;
    margin-top: 10px;
  }
  input[type="number"],
  #stationSearch {
    width: 300px;
    padding: 8px;
    box-sizing: border-box;
  }
  /* Style for autocomplete suggestions */
  #autocomplete-list {
    border: 1px solid #d4d4d4;
    max-height: 150px;
    overflow-y: auto;
    position: absolute;
    background-color: #fff;
    z-index: 99;
    width: 300px; /* match input width */
  }
  #autocomplete-list div {
    padding: 10px;
    cursor: pointer;
  }
  #autocomplete-list div:hover {
    background-color: #e9e9e9;
  }
</style>
</head>
<body>
<h2>Station Finder</h2>
<form id="stationForm">
  <label for="numberInput">Choose a number (1-50):</label>
  <input type="number" id="numberInput" name="numberInput" min="1" max="50" required />

  <label for="stationSearch">Search for a station:</label>
  <input type="text" id="stationSearch" placeholder="Type to search..." required />
  <div id="autocomplete-list"></div>

  <br><br>
  <button type="submit">Submit</button>
</form>
<p id="status"></p>

<script>
// Replace these URLs with your hosted endpoints
const stationsUrl = "https://script.google.com/macros/s/AKfycbz5ZHMrkFqii18NIo_YhQFppw_cE1l5iQrO4ID13lfw5UGfAQ0xfWJGhy57y5UmTw9W/exec"; // Your station data JSON API
const submitUrl = "https://script.google.com/macros/s/AKfycbz5ZHMrkFqii18NIo_YhQFppw_cE1l5iQrO4ID13lfw5UGfAQ0xfWJGhy57y5UmTw9W/exec";    // Your form submission API

let stations = [];

// Fetch station list from your endpoint
fetch(stationsUrl)
  .then(response => response.json())
  .then(data => {
    stations = data.stations;
  });

// Autocomplete logic
const input = document.getElementById('stationSearch');
const listContainer = document.createElement('div');
listContainer.id = 'autocomplete-list';
input.parentNode.insertBefore(listContainer, input.nextSibling);

input.addEventListener('input', function() {
  const val = this.value.toLowerCase();
  listContainer.innerHTML = '';

  if (!val) return;

  const filtered = stations.filter(station => station.toLowerCase().includes(val));

  filtered.forEach(station => {
    const item = document.createElement('div');
    item.innerText = station;
    item.addEventListener('click', () => {
      input.value = station;
      listContainer.innerHTML = '';
    });
    listContainer.appendChild(item);
  });
});

// Handle form submission
document.getElementById('stationForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const number = document.getElementById('numberInput').value;
  const station = document.getElementById('stationSearch').value;

  if (!number || !station) {
    alert('Please fill out all fields.');
    return;
  }

  fetch(submitUrl, {
    method: 'POST',
    body: JSON.stringify({ number: number, station: station }),
    headers: { 'Content-Type': 'application/json' }
  })
  .then(res => res.text())
  .then(msg => {
    document.getElementById('status').innerText = 'Thank you! Your entry has been recorded.';
  })
  .catch(err => {
    document.getElementById('status').innerText = 'Error submitting your entry.';
    console.error('Error submitting:', err);
  });
});
</script>
</body>
</html>
